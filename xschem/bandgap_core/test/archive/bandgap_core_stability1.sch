v { version=2.9.8 file_version=1.2}
G {}
K {}
V {}
S {}
E {}
N 1660 -170 1660 -90 {lab=#net1}
N 1420 -270 1420 -200 {lab=#net2}
N 1420 -140 1420 -90 {lab=#net3}
N 1360 -60 1380 -60 {lab=GND}
N 1360 -60 1360 0 {lab=GND}
N 1360 0 1420 0 {lab=GND}
N 1420 -30 1420 0 {lab=GND}
N 1660 -30 1660 0 {lab=GND}
N 1660 0 1720 0 {lab=GND}
N 1720 -60 1720 0 {lab=GND}
N 1700 -60 1720 -60 {lab=GND}
N 1320 -890 1420 -890 {lab=#net4}
N 1420 -890 1420 -860 {lab=#net4}
N 1420 -890 1660 -890 {lab=#net4}
N 1660 -890 1660 -860 {lab=#net4}
N 1600 0 1660 0 {lab=GND}
N 1130 0 1360 0 {lab=GND}
N 2670 0 3150 0 {lab=GND}
N 2610 -30 2610 0 {lab=GND}
N 1660 -230 1660 -170 {lab=#net1}
N 1720 0 2610 0 {lab=GND}
N 580 -250 630 -250 {lab=ptat}
N 710 -190 710 0 {lab=GND}
N 3150 -130 3150 0 {lab=GND}
N 2610 -210 2610 -90 {lab=#net5}
N 2610 -210 3050 -210 {lab=#net5}
N 1660 -890 2610 -890 {lab=#net4}
N 710 -710 710 -310 {lab=#net4}
N 3150 -490 3150 -250 {lab=#net4}
N 3120 -890 3150 -890 {lab=#net4}
N 2610 -890 2610 -860 {lab=#net4}
N 3630 -890 3630 -860 {lab=#net4}
N 3420 -890 3630 -890 {lab=#net4}
N 3420 -890 3420 -860 {lab=#net4}
N 3630 -120 3630 -90 {lab=#net6}
N 3420 -650 3420 -570 {lab=#net6}
N 3420 -570 3630 -570 {lab=#net6}
N 3700 -60 3880 -60 {lab=#net6}
N 3630 -120 3700 -120 {lab=#net6}
N 3700 -120 3700 -60 {lab=#net6}
N 3630 0 3920 0 {lab=GND}
N 3920 -30 3920 0 {lab=GND}
N 3630 -30 3630 0 {lab=GND}
N 3610 -60 3630 -60 {lab=GND}
N 3610 -60 3610 0 {lab=GND}
N 3920 -60 3940 -60 {lab=GND}
N 3940 -60 3940 0 {lab=GND}
N 3920 0 3940 0 {lab=GND}
N 3920 -890 3920 -740 {lab=#net4}
N 3840 -710 3880 -710 {lab=cas}
N 3840 -710 3840 -650 {lab=cas}
N 3840 -650 3920 -650 {lab=cas}
N 3920 -680 3920 -650 {lab=cas}
N 3630 -890 3920 -890 {lab=#net4}
N 3920 -650 3920 -90 {lab=cas}
N 3920 -710 3940 -710 {lab=#net4}
N 3940 -890 3940 -710 {lab=#net4}
N 3920 -890 3940 -890 {lab=#net4}
N 3150 -890 3420 -890 {lab=#net4}
N 3630 -640 3630 -570 {lab=#net6}
N 3630 -570 3630 -120 {lab=#net6}
N 3670 -60 3700 -60 {lab=#net6}
N 3610 0 3630 0 {lab=GND}
N 3150 0 3610 0 {lab=GND}
N 2700 -790 2770 -790 {lab=ctat}
N 3270 -310 3270 -190 {lab=ctat}
N 3230 -190 3270 -190 {lab=ctat}
N 2770 -310 2770 -290 {lab=ctat}
N 580 -380 580 -250 {lab=ptat}
N 1280 -790 1280 -380 {lab=ptat}
N 1280 -790 1330 -790 {lab=ptat}
N 2770 -170 3050 -170 {lab=#net1}
N 470 -890 710 -890 {lab=#net4}
N 470 0 710 0 {lab=GND}
N 1420 -60 1480 -60 { lab=GND}
N 1480 -60 1480 0 { lab=GND}
N 1600 -60 1660 -60 { lab=GND}
N 1600 -60 1600 0 { lab=GND}
N 1440 -170 1480 -170 { lab=GND}
N 1480 -170 1480 -60 { lab=GND}
N 2630 -60 2670 -60 { lab=GND}
N 2670 -60 2670 0 { lab=GND}
N 1420 0 1480 0 {lab=GND}
N 1480 0 1600 0 {lab=GND}
N 2610 0 2670 0 {lab=GND}
N 3120 -460 3120 -250 { lab=#net7}
N 1420 -640 1420 -410 { lab=#net8}
N 1420 -350 1420 -270 { lab=#net2}
N 1660 -350 1660 -230 { lab=#net1}
N 1660 -640 1660 -410 { lab=#net9}
N 2610 -350 2610 -210 { lab=#net5}
N 2610 -640 2610 -410 { lab=#net10}
N 1660 -170 2770 -170 {lab=#net1}
N 740 -680 740 -370 { lab=#net11}
N 2770 -230 2770 -170 { lab=#net1}
N 2770 -310 3270 -310 { lab=ctat}
N 2770 -790 2770 -310 {lab=ctat}
N 330 -890 470 -890 { lab=#net4}
N 470 -890 470 -730 { lab=#net4}
N 470 -630 470 0 { lab=GND}
N 270 0 470 0 { lab=GND}
N 330 -680 380 -680 { lab=#net4}
N 330 -890 330 -680 { lab=#net4}
N 710 -710 740 -710 { lab=#net4}
N 740 -890 740 -740 { lab=#net4}
N 3120 -490 3150 -490 { lab=#net4}
N 3120 -890 3120 -520 { lab=#net4}
N 2610 -890 3120 -890 { lab=#net4}
N 710 -890 710 -710 {lab=#net4}
N 3150 -890 3150 -490 {lab=#net4}
N 710 -890 740 -890 {lab=#net4}
N 270 -890 330 -890 { lab=#net4}
N 270 -370 270 0 { lab=GND}
N 270 -890 270 -430 { lab=#net4}
N 1130 -140 1130 -100 { lab=#net12}
N 710 0 1130 0 {lab=GND}
N 850 -380 990 -380 { lab=ptat}
N 1130 -40 1130 0 { lab=GND}
N 1130 -380 1280 -380 { lab=ptat}
N 1310 -860 1320 -860 { lab=#net4}
N 1320 -890 1320 -860 { lab=#net4}
N 1280 -890 1280 -860 { lab=#net4}
N 1240 -860 1250 -860 { lab=#net4}
N 1240 -890 1240 -860 { lab=#net4}
N 1280 -890 1320 -890 {lab=#net4}
N 580 -380 850 -380 { lab=ptat}
N 1050 -380 1130 -380 { lab=ptat}
N 1240 -890 1280 -890 {lab=#net4}
N 1150 -890 1240 -890 {lab=#net4}
N 740 -890 1150 -890 {lab=#net4}
N 1280 -820 1280 -790 { lab=ptat}
N 1250 -230 1660 -230 { lab=#net1}
N 1250 -270 1420 -270 { lab=#net2}
N 810 -270 1190 -270 { lab=#net13}
N 810 -230 1190 -230 { lab=#net14}
N 990 -380 1050 -380 { lab=ptat}
N 1130 -270 1130 -200 { lab=#net13}
N 970 -140 970 -100 { lab=#net15}
N 970 -40 970 0 { lab=GND}
N 970 -230 970 -200 { lab=#net14}
N 1370 -320 1380 -320 { lab=#net1}
N 1380 -320 1380 -230 { lab=#net1}
N 1370 -360 1390 -360 { lab=#net2}
N 1390 -360 1390 -270 { lab=#net2}
N 1940 -860 1950 -860 { lab=#net4}
N 1940 -890 1940 -860 { lab=#net4}
N 1860 -890 1940 -890 {lab=#net4}
N 1860 -890 1860 -860 {lab=#net4}
N 1860 -640 1860 -220 { lab=#net16}
N 1900 -280 1900 -220 { lab=#net1}
N 1900 -80 1900 0 { lab=GND}
N 1720 -140 1800 -140 { lab=ctl_ptat[4:0]}
N 2240 -860 2250 -860 { lab=#net4}
N 2240 -890 2240 -860 { lab=#net4}
N 2160 -890 2240 -890 {lab=#net4}
N 2160 -890 2160 -860 {lab=#net4}
N 2160 -640 2160 -220 { lab=#net17}
N 2200 -280 2200 -220 { lab=#net2}
N 2200 -80 2200 0 { lab=GND}
N 2020 -140 2100 -140 { lab=ctl_ptat[4:0]}
N 2200 -320 2200 -280 { lab=#net2}
N 3480 -1130 3480 -1110 { lab=ctl_ptat[0]}
N 3480 -1130 3520 -1130 { lab=ctl_ptat[0]}
N 3380 -1130 3380 -1110 { lab=ctl_ptat[1]}
N 3380 -1130 3420 -1130 { lab=ctl_ptat[1]}
N 3280 -1130 3280 -1110 { lab=ctl_ptat[2]}
N 3280 -1130 3320 -1130 { lab=ctl_ptat[2]}
N 3180 -1130 3180 -1110 { lab=ctl_ptat[3]}
N 3180 -1130 3220 -1130 { lab=ctl_ptat[3]}
N 3080 -1130 3080 -1110 { lab=ctl_ptat[4]}
N 3080 -1130 3120 -1130 { lab=ctl_ptat[4]}
N 3080 -1050 3080 -1030 { lab=GND}
N 3080 -1030 3480 -1030 { lab=GND}
N 3480 -1050 3480 -1030 { lab=GND}
N 3380 -1050 3380 -1030 { lab=GND}
N 3280 -1050 3280 -1030 { lab=GND}
N 3180 -1050 3180 -1030 { lab=GND}
N 3080 -1030 3080 -1010 { lab=GND}
N 1660 -280 1900 -280 { lab=#net1}
N 1420 -320 2200 -320 { lab=#net2}
C {bandgap_opamp/bandgap_opamp.sym} 710 -250 0 1 {name=x1}
C {bandgap_opamp/bandgap_opamp.sym} 3150 -190 0 0 {name=x2}
C {lab_wire.sym} 1330 -790 0 0 {name=l1 sig_type=std_logic lab=ptat}
C {lab_wire.sym} 1570 -790 0 0 {name=l2 sig_type=std_logic lab=ptat}
C {lab_wire.sym} 2700 -790 0 1 {name=l3 sig_type=std_logic lab=ctat}
C {lab_wire.sym} 1330 -710 0 0 {name=l4 sig_type=std_logic lab=cas}
C {lab_wire.sym} 1570 -710 0 0 {name=l5 sig_type=std_logic lab=cas}
C {lab_wire.sym} 2700 -710 0 1 {name=l6 sig_type=std_logic lab=cas}
C {lab_wire.sym} 3330 -710 0 0 {name=l7 sig_type=std_logic lab=cas}
C {lab_wire.sym} 3540 -710 0 0 {name=l8 sig_type=std_logic lab=cas}
C {lab_wire.sym} 3330 -790 0 0 {name=l9 sig_type=std_logic lab=ptat}
C {lab_wire.sym} 3540 -790 0 0 {name=l10 sig_type=std_logic lab=ctat}
C {lab_wire.sym} 3840 -710 0 1 {name=l11 sig_type=std_logic lab=cas}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 3900 -710 0 0 {name=M8
L=8
W=5
ad="'W * 0.29'" pd="'2 * (W + 0.29)'"
as="'W * 0.29'" ps="'2 * (W + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
nf=1 mult=1
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3650 -60 0 1 {name=M3
L=8
W=5
ad="[expr @W *0.29]" pd="[expr 2*(@W + 0.29)]"
as="[expr @W *0.29]" ps="[expr 2*(@W + 0.29)]"
nrd="[expr 0.29/@W ]" nrs="[expr 0.29/@W ]"
sa=0 sb=0 sd=0
nf=1 mult=2
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3900 -60 0 0 {name=M1
L=8
W=5
ad="[expr @W *0.29]" pd="[expr 2*(@W + 0.29)]"
as="[expr @W *0.29]" ps="[expr 2*(@W + 0.29)]"
nrd="[expr 0.29/@W ]" nrs="[expr 0.29/@W ]"
sa=0 sb=0 sd=0
nf=1 mult=2
model=nfet_01v8_lvt
spiceprefix=X
}
C {spice_probe.sym} 1420 -270 0 0 {name=p6 analysis=tran voltage=0.7342}
C {spice_probe.sym} 1660 -230 0 0 {name=p7 analysis=tran voltage=0.7341}
C {spice_probe.sym} 2610 -210 0 0 {name=p8 analysis=tran voltage=0.7341}
C {spice_probe.sym} 2700 -710 0 0 {name=p12 analysis=tran voltage=0.5687}
C {ammeter.sym} 740 -340 0 0 {name=v2 current=7.5997e-06}
C {bandgap_cascurr_cell/bandgap_cascurr_cell.sym} 1420 -750 0 0 {name=x5 m=8}
C {bandgap_cascurr_cell/bandgap_cascurr_cell.sym} 1660 -750 0 0 {name=x6 m=8}
C {bandgap_cascurr_cell/bandgap_cascurr_cell.sym} 2610 -750 0 1 {name=x7 m=8}
C {bandgap_cascurr_cell/bandgap_cascurr_cell.sym} 3420 -750 0 0 {name=x10 m=4}
C {bandgap_cascurr_cell/bandgap_cascurr_cell.sym} 3630 -750 0 0 {name=x11 m=4}
C {sky130_fd_pr/pnp_05v5.sym} 1400 -60 0 0 {name=Q1
m=8
model=pnp_05v5_W3p40L3p40
spiceprefix=X
}
C {sky130_fd_pr/pnp_05v5.sym} 1680 -60 0 1 {name=Q2
m=1
model=pnp_05v5_W3p40L3p40
spiceprefix=X
}
C {ammeter.sym} 1420 -380 0 0 {name=v3 current=7.9258e-06}
C {ammeter.sym} 1660 -380 0 0 {name=v5 current=7.9257e-06}
C {ammeter.sym} 2610 -380 0 0 {name=v6 current=1.2106e-05}
C {capa.sym} 2770 -260 0 0 {name=C1
m=1
value=1m
footprint=1206
device="ceramic capacitor"}
C {sky130_fd_pr/res_xhigh_po.sym} 1420 -170 0 1 {name=R1
W=1
L=3.25
model=res_xhigh_po
spiceprefix=X
m=1}
C {sky130_fd_pr/res_xhigh_po.sym} 2610 -60 0 1 {name=R2
W=1
L=28.6
model=res_xhigh_po
spiceprefix=X
m=1}
C {spice_probe.sym} 740 -550 0 1 {name=p11 analysis=tran voltage=0.8189}
C {spice_probe.sym} 2830 -310 0 0 {name=p9 analysis=tran voltage=1.004}
C {bandgap_bmr/bandgap_bmr.sym} 470 -680 0 0 {name=x8}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 760 -710 0 1 {name=Mcurr
L=8
W=5
ad="'W * 0.29'" pd="'2 * (W + 0.29)'"
as="'W * 0.29'" ps="'2 * (W + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
nf=1 mult=1
model=pfet_01v8_lvt
spiceprefix=X
}
C {lab_wire.sym} 560 -680 0 1 {name=l12 sig_type=std_logic lab=bmr_biasv}
C {lab_wire.sym} 780 -710 0 1 {name=l13 sig_type=std_logic lab=bmr_biasv}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 3100 -490 0 0 {name=Mcurr1
L=8
W=5
ad="'W * 0.29'" pd="'2 * (W + 0.29)'"
as="'W * 0.29'" ps="'2 * (W + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
nf=1 mult=1
model=pfet_01v8_lvt
spiceprefix=X
}
C {lab_wire.sym} 3080 -490 0 0 {name=l14 sig_type=std_logic lab=bmr_biasv}
C {vsource.sym} 270 -400 0 0 {name=Vdd value=\{vdd\}}
C {gnd.sym} 270 0 0 0 {name=l15 lab=GND}
C {vsource.sym} 1130 -70 0 0 {name=Vin value="dc=0 ac=1"}
C {lab_wire.sym} 1330 -370 0 1 {name=l16 sig_type=std_logic lab=fb}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 1280 -840 1 1 {name=Mcurr2
L=8
W=7
ad="'W * 0.29'" pd="'2 * (W + 0.29)'"
as="'W * 0.29'" ps="'2 * (W + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
nf=1 mult=16
model=pfet_01v8_lvt
spiceprefix=X
}
C {vsource.sym} 970 -70 0 0 {name=Vin1 value="dc=0 ac=-1"}
C {vcvs.sym} 1330 -340 0 1 {name=E1 value=1}
C {gnd.sym} 1330 -310 0 0 {name=l17 lab=GND}
C {bandgap_trim/bandgap_trim.sym} 1820 -100 0 0 {name=x3}
C {lab_wire.sym} 1770 -790 0 0 {name=l18 sig_type=std_logic lab=ptat}
C {lab_wire.sym} 1770 -710 0 0 {name=l19 sig_type=std_logic lab=cas}
C {bandgap_cascurr_cell/bandgap_cascurr_cell.sym} 1860 -750 0 0 {name=x9 m=1}
C {lab_wire.sym} 1720 -140 0 1 {name=l20 sig_type=std_logic lab=ctl_ptat[4:0]}
C {bandgap_trim/bandgap_trim.sym} 2120 -100 0 0 {name=x4}
C {lab_wire.sym} 2070 -790 0 0 {name=l21 sig_type=std_logic lab=ptat}
C {lab_wire.sym} 2070 -710 0 0 {name=l22 sig_type=std_logic lab=cas}
C {bandgap_cascurr_cell/bandgap_cascurr_cell.sym} 2160 -750 0 0 {name=x12 m=1}
C {lab_wire.sym} 2020 -140 0 1 {name=l23 sig_type=std_logic lab=ctl_ptat[4:0]}
C {code.sym} 3830 -1110 0 0 {name=simulation only_toplevel=false value="
.temp 27

.lib "sky130_fd_pr/models/sky130.lib.spice" tt
.include sky130_fd_pr/models/sky130_fd_pr__model__pnp.model.spice

.param vdd=1.8

.param ctl4=0
.param ctl3=1.8
.param ctl2=1.8
.param ctl1=0
.param ctl0=1.8

.save all

*.op
.ac dec 10 1 1G

*.control
*   run
*   setplot ac1
*   set units=degrees
*   gnuplot bandgap_core_stability2 db(fb) ph(fb)
*.endc
"}
C {vsource.sym} 3080 -1080 0 0 {name=Vctl4 value=\{ctl4\}}
C {vsource.sym} 3180 -1080 0 0 {name=Vctl3 value=\{ctl3\}}
C {vsource.sym} 3280 -1080 0 0 {name=Vctl2 value=\{ctl2\}}
C {vsource.sym} 3380 -1080 0 0 {name=Vctl1 value=\{ctl1\}}
C {vsource.sym} 3480 -1080 0 0 {name=Vctl0 value=\{ctl0\}}
C {gnd.sym} 3080 -1010 0 0 {name=l24 lab=GND}
C {lab_wire.sym} 3480 -1130 0 1 {name=l25 sig_type=std_logic lab=ctl_ptat[0]}
C {lab_wire.sym} 3380 -1130 0 1 {name=l26 sig_type=std_logic lab=ctl_ptat[1]}
C {lab_wire.sym} 3280 -1130 0 1 {name=l27 sig_type=std_logic lab=ctl_ptat[2]}
C {lab_wire.sym} 3180 -1130 0 1 {name=l28 sig_type=std_logic lab=ctl_ptat[3]}
C {lab_wire.sym} 3080 -1130 0 1 {name=l29 sig_type=std_logic lab=ctl_ptat[4]}
C {res_ac.sym} 1220 -270 1 0 {name=R3
value=1u
device=resistor
m=1
ac=1G}
C {res_ac.sym} 1220 -230 1 0 {name=R5
value=1u
device=resistor
m=1
ac=1G}
C {res_ac.sym} 1130 -170 2 0 {name=R4
value=1G
device=resistor
m=1
ac=1u}
C {res_ac.sym} 970 -170 2 0 {name=R6
value=1G
device=resistor
m=1
ac=1u}
